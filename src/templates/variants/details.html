<!-- templates/variants/details.html -->
{% extends 'base.html' %}

{% block title %}Details{% endblock %}

{% block content %}
{% if request.user.id == query.user_id %}
<div class='row my-3'>
    <div class="card border-info" style="width:60rem;">
        <div class="card-header border-bottom border-info">
            <div class="row col-md-12">
                <div class="col-md-4 text-left">
                    <h6>{{ query.label }}</h6>
                    <h6>{{ query.query }}</h6>
                </div>
                <div class="col-md-4 text-center">
                    <h6>Created</h6>
                    <h6>{{ query.date }}</h6>
                </div>
                <div class="col-md-4 text-right">
                    <h6>Changed</h6>
                    <h6>{{ query.update }}</h6>
                </div>
            </div>
        </div>
        <div class="card-body">
            <table class="table text-center border border-primary">
                <tr class="table-primary">
                    <th class="border-bottom border-primary">Assembly</th>
                    <th class="border-bottom border-primary">Chromosome</th>
                    <th class="border-bottom border-primary">Position</th>
                    <th class="border-bottom border-primary">Reference</th>
                    <th class="border-bottom border-primary">Alternate</th>
                </tr>
                <tr class="table-light">
                    <td>{{ query.assembly }}</td>
                    <td>{{ query.chromosome }}</td>
                    <td>{{ query.position }}</td>
                    <td>{{ query.variant_ref }}</td>
                    <td>{{ query.variant_alt }}</td>
                </tr>
            </table>
            <div class="card-text border border-primary">
                <ul class="nav nav-tabs bg-light border-bottom border-primary">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#new">Current</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#old">Previous</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#diff">Difference</a>
                    </li>
                </ul>
                <div id="myTabContent" class="tab-content">
                    <div class="tab-pane fade " id="old">
                        <pre id="resultBefore">{{ query.previous }}</pre>
                    </div>
                    <div class="tab-pane fade show active" id="new">
                        <pre id="resultAfter">{{ query.result }}</pre>
                    </div>
                    <div class="tab-pane fade" id="diff">
                        <pre id="difference">{{ query.difference }}</pre>
                    </div>
                </div>
            </div>
            <div class="text-right mt-2">
                <button class="btn btn-sm btn-outline-success" onclick="rerun('{{ query.id }}');">ReRun</button>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="alert alert-dismissible alert-danger" style="width:100rem">
    <h1 class="alert-heading">404</h1>
    <p class="mb-2">
    <h2>OPS! Page not found!</h2></p>
    <h3>The page you are looking for doesn't exist:
        <a href="{% url 'home' %}">Come back home!</a>
    </h3>
</div>{% endif %}
<div class="modal fade" tabindex="-1" role="dialog" id="spinnerModal">
    <div class="modal-dialog modal-dialog-centered text-center" role="document">
        <div class="modal-body">
            <h1 class="text-white">Wait while loading...</h1>
            <div class="spinner-border text-info"
                 style="width: 5rem; height: 5rem;"
                 role="status">
                <span class="sr-only">Loading...</span>
            </div>
            <h3 class="text-white">It may take a long time</h3>
        </div>
    </div>
</div>

<script>
    prettyJson('#resultBefore');
    prettyJson('#resultAfter');
    prettyJson('#difference');
</script>

{% endblock %}
